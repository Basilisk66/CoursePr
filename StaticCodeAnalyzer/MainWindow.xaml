<Window x:Class="StaticCodeAnalyzer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Static Code Analyzer" Height="700" Width="900"
        Background="#2D2D30" Foreground="#CCCCCC">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>

        <!-- Стиль для заголовков DataGrid -->
        <Style x:Key="DarkDataGridColumnHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#3E3E42"/>
            <Setter Property="Foreground" Value="#CCCCCC"/>
            <Setter Property="BorderBrush" Value="#555555"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>

        <!-- Упрощенный стиль для скроллбаров -->
        <Style TargetType="ScrollBar">
            <Setter Property="Background" Value="#3E3E42"/>
            <Setter Property="BorderBrush" Value="#555555"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="3*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="2*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Панель управления -->
        <Border Grid.Row="0" Background="#3E3E42" Margin="5" Padding="10">
            <StackPanel Orientation="Horizontal">
                <Button x:Name="LoadFileButton" Content="Выбор файла" Click="LoadFileButton_Click" Margin="5"
                        Background="#007ACC" Foreground="White" Padding="10,5"/>
                <Button x:Name="SelectLanguageButton" Content="Выбор языка" 
                        Click="SelectLanguageButton_Click" Margin="5"
                        Background="#555555" Foreground="#888888" 
                        Padding="10,5" IsEnabled="False"/>
                <Button x:Name="AnalyzeButton" Content="Анализ кода" Click="AnalyzeButton_Click" Margin="5"
                        Background="#555555" Foreground="#888888" Padding="10,5"/>
                <TextBlock x:Name="LanguageTextBlock" VerticalAlignment="Center" Margin="10,5" 
                           FontWeight="Bold" FontSize="14" Foreground="#FFCC00"/>
                <TextBlock x:Name="FileExtensionTextBlock" VerticalAlignment="Center" Margin="5" 
                           Foreground="#888888" FontStyle="Italic"/>
            </StackPanel>
        </Border>

        <!-- Область с кодом и нумерацией строк -->
        <Border Grid.Row="1" Margin="5" Background="#1E1E1E" BorderBrush="#555555" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Контейнер для нумерации строк -->
                <ScrollViewer Grid.Column="0" x:Name="LineNumbersScrollViewer" 
             VerticalScrollBarVisibility="Hidden" 
             HorizontalScrollBarVisibility="Hidden"
             Background="#252526"
             VerticalAlignment="Stretch">
                    <ItemsControl x:Name="LineNumbersControl" VerticalAlignment="Top">
                        <ItemsControl.ItemContainerStyle>
                            <Style TargetType="ContentPresenter">
                                <Setter Property="Height" Value="20"/>
                                <Setter Property="VerticalAlignment" Value="Top"/>
                            </Style>
                        </ItemsControl.ItemContainerStyle>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding}" 
                           Padding="5,0,10,0" 
                           Foreground="#569CD6" 
                           FontFamily="Consolas" 
                           FontSize="14"
                           LineHeight="20"
                           VerticalAlignment="Center"
                           TextAlignment="Right"/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>

                <!-- Область с кодом -->
                <ScrollViewer Grid.Column="1" x:Name="CodeScrollViewer"
                             VerticalScrollBarVisibility="Auto"
                             HorizontalScrollBarVisibility="Auto"
                             Background="#1E1E1E">
                    <TextBox x:Name="CodeTextBox" 
                             AcceptsReturn="True" AcceptsTab="True"
                             FontFamily="Consolas" FontSize="14"
                             TextChanged="CodeTextBox_TextChanged"
                             VerticalAlignment="Top" HorizontalAlignment="Stretch"
                             TextWrapping="NoWrap"
                             BorderThickness="0"
                             Background="#1E1E1E"
                             Foreground="#CCCCCC"
                             CaretBrush="#FFFFFF"/>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- Разделитель -->
        <GridSplitter Grid.Row="2" Height="3" HorizontalAlignment="Stretch" 
                     Background="#555555" ResizeBehavior="PreviousAndNext"/>

        <!-- Список ошибок -->
        <DataGrid x:Name="ErrorsDataGrid" Grid.Row="3" Margin="5"
                  AutoGenerateColumns="False" 
                  IsReadOnly="True"
                  SelectionMode="Single"
                  SelectionChanged="ErrorsDataGrid_SelectionChanged"
                  Background="#1E1E1E"
                  Foreground="#CCCCCC"
                  BorderBrush="#555555"
                  RowBackground="#1E1E1E"
                  AlternatingRowBackground="#252526"
                  ColumnHeaderStyle="{StaticResource DarkDataGridColumnHeaderStyle}">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Line" Binding="{Binding LineNumber}" Width="60"/>
                <DataGridTextColumn Header="Type" Binding="{Binding ErrorType}" Width="120"/>
                <DataGridTextColumn Header="Description" Binding="{Binding Message}" Width="*"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Панель исправлений -->
        <Border Grid.Row="4" Background="#3E3E42" Margin="5" Padding="10">
            <StackPanel Orientation="Vertical">
                <!-- Сообщение об ошибке -->
                <TextBlock Text="Message:" FontWeight="Bold" Foreground="#FFCC00"/>
                <TextBlock x:Name="ErrorMessageTextBlock" TextWrapping="Wrap" Margin="0,2" 
                           Text="Select an error to see details" Foreground="#CCCCCC" Height="40"/>

                <!-- Область для отображения "до" и "после" -->
                <Grid x:Name="FixPreviewGrid" Visibility="Collapsed" Margin="0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" Margin="5">
                        <TextBlock Text="Before:" FontWeight="Bold" Foreground="#FF6B6B"/>
                        <TextBox x:Name="BeforeTextBox" IsReadOnly="True" Height="80" 
                                 FontFamily="Consolas" FontSize="12"
                                 Background="#1E1E1E" Foreground="#CCCCCC" 
                                 BorderBrush="#555555" BorderThickness="1"/>
                    </StackPanel>
                    <StackPanel Grid.Column="1" Margin="5">
                        <TextBlock Text="After:" FontWeight="Bold" Foreground="#4EC9B0"/>
                        <TextBox x:Name="AfterTextBox" IsReadOnly="True" Height="80"
                                 FontFamily="Consolas" FontSize="12"
                                 Background="#1E1E1E" Foreground="#CCCCCC" 
                                 BorderBrush="#555555" BorderThickness="1"/>
                    </StackPanel>
                </Grid>

                <!-- Кнопки действий -->
                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                    <Button x:Name="ShowFixButton" Content="Показать возможные решения" 
                            Click="ShowFixButton_Click" Margin="5"
                            Background="#555555" Foreground="#888888" Padding="10,5"/>
                    <Button x:Name="ApplyFixButton" Content="Исправить" 
                            Click="ApplyFixButton_Click" Margin="5"
                            Background="#555555" Foreground="#888888" Padding="10,5"/>
                    <Button x:Name="ApplyAllButton" Content="Исправить все" 
                            Click="ApplyAllButton_Click" Margin="5"
                            Background="#555555" Foreground="#888888" Padding="10,5"/>
                </StackPanel>
            </StackPanel>
        </Border>
    </Grid>
</Window>